<script lang="ts">
	import { useQuery } from '@sanity/svelte-loader';
	import { isPreviewing, VisualEditing } from '@sanity/visual-editing/svelte';
	import { onMount } from 'svelte';
	import { fade } from 'svelte/transition';
	import Footer from '../components/Footer.svelte';
	import LiveMode from '../components/LiveMode.svelte';
	import Nav from '../components/Nav/Nav.svelte';
	import '../styles/app.css';

	export let data;

	console.log('layout data', data);

	const q = useQuery(data);

	$: ({ data: siteData } = $q);

	$: console.log(siteData);

	let firstOpen = true;

	onMount(() => {
		setTimeout(() => {
			firstOpen = false;
		}, 500);
	});

	$: transitionKey =
		data?.pathname &&
		data.pathname
			.replace(/\/exhibitions\/[^/]+/, '/exhibitions/*')
			.replace(/\/artists\/[^/]+/, '/artists/*');
</script>

<!-- {#if $isPreviewing}
	<a
		href={`/preview/disable?redirect=${$page.url.pathname}`}
		class="inline-flex opacity-50 z-50 bottom-0 left-0 h-min fixed bg-black/10 px-3 items-center gap-2 text-sm text-neutral-600 hover:text-neutral-900 underline-offset-4 hover:underline transition"
	>
		<span>Preview enabled</span>
		<span class="opacity-60">Disable</span>
	</a>
{/if} -->

<Nav data={siteData} />

{#key transitionKey}
	<div class="anim-opacity" in:fade={{ duration: 200, delay: 200 }} out:fade={{ duration: 200 }}>
		<slot />
	</div>
{/key}

{#if $isPreviewing}
	<VisualEditing />
	<LiveMode />
{/if}

<Footer data={siteData} />

{#if firstOpen}
	<div
		transition:fade={{ duration: 500 }}
		class="fixed top-0 left-0 w-screen h-dvh z-999999999999 bg-white main-grid px-page items-center justify-center"
	>
		<svg
			class="col-span-6 col-start-3 sm:col-span-5 sm:col-start-6 lg:col-span-3 lg:col-start-7 w-full"
			viewBox="0 0 242 83"
			fill="none"
			xmlns="http://www.w3.org/2000/svg"
			style="transform: translate(0%, -16.8%);"
		>
			<path
				d="M188.506 61.7966C190.081 62.521 189.996 63.7986 189.648 65.7263C189.411 67.0466 188.815 68.3691 188.109 69.5259C186.02 72.9499 183.892 76.3581 181.595 79.6439C179.963 81.9787 177.659 82.1171 175.426 80.3142C173.157 78.4818 171.9 75.9947 170.926 73.3249C170.09 71.0359 169.382 68.685 168.346 66.4899C167.694 65.11 166.657 63.8517 165.575 62.7542C164.692 61.8587 163.784 62.1339 163.549 63.3754C163.158 65.4391 162.974 67.555 162.901 69.6559C162.883 70.171 163.522 70.8989 164.048 71.203C165.071 71.7941 166.228 72.1513 167.327 72.6111C169.733 73.6177 170.759 75.1196 170.573 77.3513C170.368 79.799 168.048 81.5347 165.683 80.8518C163.499 80.2212 161.342 79.7635 159.036 79.7329C157.527 79.7128 156.143 79.121 154.481 79.6765C153.141 80.1239 151.452 79.7431 149.964 79.4756C147.654 79.0603 146.957 76.2833 148.604 74.2032C149.173 73.4847 149.862 72.83 150.596 72.2789C153.462 70.1269 154.485 67.1792 154.51 63.7284C154.525 61.7323 154.282 59.6776 155.532 57.8754C155.688 57.6496 155.591 57.2438 155.601 56.9211C155.696 53.6841 155.743 50.4445 155.909 47.2111C155.964 46.1372 156.377 45.0864 156.529 44.0113C156.662 43.0677 156.653 42.1045 156.719 41.1508C156.809 39.8347 156.789 38.4964 157.032 37.2084C157.597 34.213 158.424 31.2628 158.899 28.2556C159.456 24.7292 160.445 21.3614 161.851 18.0964C163.209 14.9431 164.461 11.7409 165.921 8.63617C167.179 5.9618 168.636 3.08716 171.568 2.16915C174.005 1.40608 176.246 -0.227102 178.989 0.0264629C181.038 0.215916 182.846 0.960491 184.335 2.37709C185.889 3.85678 185.812 5.76027 185.464 7.64685C185.258 8.76582 184.837 9.84508 184.513 10.9423C183.699 13.6975 181.719 15.2521 179.15 16.258C177.53 16.8922 175.943 17.6153 174.366 18.351C172.596 19.1768 171.321 20.3554 170.748 22.3974C170.16 24.4963 168.937 26.4174 168.349 28.5164C167.537 31.4108 167.09 34.4059 166.422 37.3433C166.202 38.3136 165.763 39.2326 165.457 40.1857C164.944 41.7842 164.269 43.3834 165.301 45.261C165.737 44.8933 166.11 44.6004 166.459 44.2813C167.753 43.0979 168.949 41.7856 170.346 40.7414C173.503 38.3812 176.212 38.8764 178.486 42.0724C178.726 42.4091 178.938 42.7652 179.171 43.1064C181.123 45.9596 181.411 48.8222 179.377 51.7991C178.469 53.1276 177.791 54.6114 176.917 55.9652C176.015 57.3615 175.709 58.7556 176.128 60.418C176.696 62.6705 177.311 64.8937 178.85 66.6763C180.508 68.5982 181.358 68.6944 182.598 66.4212C183.405 64.9423 184.604 63.6181 185.85 62.4648C186.425 61.9328 187.532 61.9759 188.506 61.7966ZM166.581 50.3004C164.909 51.4242 164.338 53.0613 164.514 54.976C164.65 56.4536 165.657 57.0272 166.786 56.1112C167.964 55.1546 168.98 53.9217 169.808 52.6419C170.195 52.0434 170.243 50.9361 169.96 50.2625C169.546 49.276 168.488 49.5676 167.627 49.7974C167.321 49.8791 167.038 50.0437 166.581 50.3004Z"
				fill="#010101"
			/>
			<path
				d="M134.102 67.4678C135.627 64.405 136.399 61.2132 136.9 57.9759C137.09 56.7543 136.807 55.4253 136.559 54.1813C136.362 53.1968 135.547 53.0697 134.906 53.7283C134.114 54.5412 133.244 55.4322 132.858 56.4587C131.086 61.1721 129.491 65.9516 127.792 70.6932C126.82 73.4096 125.906 76.1599 124.717 78.7824C123.626 81.1896 122.437 81.5693 119.906 80.6912C115.762 79.2533 115.392 78.4051 116.613 73.4299C117.367 70.3574 118.821 67.4635 119.758 64.4268C120.475 62.1022 120.845 59.6724 121.43 57.3045C121.614 56.5604 122.124 55.8861 122.245 55.1409C122.331 54.6097 122.155 53.9031 121.825 53.4916C121.654 53.2781 120.799 53.376 120.419 53.6063C118.364 54.8496 117.28 56.9142 116.086 58.893C113.145 63.7652 111.339 69.0825 109.671 74.4843C109.17 76.1075 108.1 77.606 107.072 79.0011C106.042 80.4008 104.474 81.2392 102.723 80.7874C100.937 80.3265 100.541 78.661 99.9325 77.0582C99.0441 74.7188 99.8613 72.804 100.519 70.6789C101.975 65.973 103.23 61.204 104.523 56.449C104.927 54.964 105.244 53.4497 105.491 51.9308C105.568 51.4526 105.285 50.9159 105.109 50.1543C104.161 50.8487 103.447 51.386 102.718 51.9035C100.851 53.2291 98.4791 53.1415 97.6606 51.7259C96.9392 50.478 98.0994 47.9625 99.8063 46.9972C100.278 46.7306 100.702 46.3735 101.124 46.0283C104.238 43.4803 107.316 40.8864 110.475 38.3963C111.359 37.6992 112.379 37.1658 113.7 37.5154C114.924 37.8395 115.561 38.5292 115.548 39.6966C115.532 41.2567 115.331 42.8142 115.234 44.3744C115.146 45.7986 115.03 47.2262 115.058 48.6498C115.067 49.1281 115.386 49.8777 115.735 49.9965C116.109 50.1235 116.852 49.7861 117.147 49.4201C118.814 47.3484 120.38 45.1969 122.008 43.0932C123.27 41.4616 124.517 39.8125 125.873 38.2602C126.969 37.0048 128.037 36.8748 129.652 37.529C132.82 38.8123 134.639 42.3531 133.859 45.6635C133.708 46.3054 133.669 46.9735 133.89 47.7753C134.854 46.6871 135.779 45.5603 136.791 44.5192C138.459 42.8045 140.099 41.044 141.923 39.5076C142.769 38.7944 143.993 38.276 145.095 38.1683C147.905 37.8934 149.915 39.8051 149.525 42.585C148.974 46.5213 148.208 50.4454 147.236 54.2998C146.28 58.0937 144.903 61.7797 143.821 65.5448C143.513 66.618 143.591 67.8022 143.46 69.2967C144.183 68.8284 144.607 68.5131 145.067 68.2641C146.312 67.5896 147.527 66.8121 148.851 66.3515C149.363 66.173 150.432 66.5545 150.711 67.0097C151.037 67.5421 151.09 68.7042 150.724 69.1258C148.002 72.2592 145.149 75.2785 142.332 78.3289C141.642 79.0759 140.993 79.8767 140.218 80.5246C139.316 81.2785 138.384 82.2185 137.312 82.5046C134.081 83.3664 131.482 80.6838 131.569 77.0445C131.651 73.6604 132.752 70.5981 134.102 67.4678Z"
				fill="#010101"
			/>
			<path
				d="M48.6173 56.4566C48.5323 54.2018 48.7845 52.1572 49.2919 50.0721C49.6014 48.7997 48.9172 47.3077 48.8104 45.9043C48.7359 44.9253 48.841 43.925 48.941 42.9419C49.1441 40.9456 49.4523 38.958 49.5793 36.958C49.6013 36.6119 49.0098 36.0374 48.5883 35.888C47.3034 35.4326 45.96 35.1443 44.6452 34.7704C43.2019 34.36 42.6469 33.4865 43.0935 32.0809C43.5831 30.5398 44.4896 29.2309 46.17 28.8737C48.2497 28.4317 50.3618 28.1267 52.4715 27.8513C53.0829 27.7715 53.762 27.9071 54.3622 28.096C57.6624 29.135 61.0479 28.5409 64.3933 28.6592C66.5936 28.737 67.3633 29.1828 67.5125 30.7338C67.764 33.349 66.7783 35.1896 64.8965 35.5937C64.582 35.6612 64.2547 35.6786 63.9321 35.6973C60.285 35.9089 60.0037 37.48 60.4115 40.3073C61.5899 48.4767 60.9304 56.6409 60.8783 64.804C60.8603 67.6258 61.4053 70.1284 63.536 71.9584C66.1214 74.1789 69.1557 74.1333 72.224 73.0041C75.2021 71.9082 76.5079 69.2077 78.0294 66.7644C79.3003 64.7234 79.8783 62.511 79.7962 60.0135C79.7154 57.556 80.2743 55.0842 80.3594 52.6121C80.415 50.9978 80.1304 49.3713 79.9896 47.751C79.9382 47.1596 79.8551 46.571 79.7987 45.9799C79.5458 43.3288 79.3427 40.672 79.0334 38.0276C78.7631 35.7164 78.7111 35.7225 76.5465 35.1501C74.8728 34.7076 74.1305 33.5322 74.8252 31.7905C75.3161 30.5599 76.1941 29.4216 77.1134 28.4434C77.8744 27.6338 78.9778 27.6099 80.0471 28.1154C83.9748 29.9722 88.0702 30.2169 92.2714 29.315C94.881 28.7549 96.7502 29.9635 97.1345 32.5598C97.3155 33.7827 97.4442 35.0336 97.3957 36.2638C97.3557 37.2759 96.8334 37.9726 95.5793 37.8001C94.7209 37.682 93.8319 37.7501 92.9586 37.7847C91.3124 37.8499 90.6016 38.4374 90.4889 40.0837C90.3969 41.4276 90.4148 43.3931 90.4148 43.949C90.4148 44.3014 90.4148 44.9219 90.2758 45.4779C90.1596 45.9427 89.9334 48.1634 90.265 49.9768C90.4628 51.0585 90.2701 52.2344 90.1242 53.3512C89.8637 55.3453 89.5639 57.3386 89.1656 59.3089C88.9424 60.4129 88.9982 61.3873 89.244 62.5137C89.5434 63.8851 89.1365 65.3993 89.1242 66.8525C89.0961 70.1828 86.2379 72.2006 85.3266 75.1251C85.1629 75.6505 84.637 76.0894 84.213 76.501C83.6186 77.0779 82.8507 77.5049 82.353 78.1477C80.183 80.95 77.0984 82.0121 73.8266 82.52C68.7053 83.3151 63.6426 82.9791 58.6265 81.4809C55.3104 80.4905 53.4719 78.1031 51.9564 75.3195C51.1252 73.7928 50.4755 72.1618 49.8247 70.5453C49.6105 70.0133 49.5917 69.3802 49.5828 68.7918C49.5396 65.9449 49.6804 63.1082 48.7661 60.3134C48.395 59.179 48.6482 57.8403 48.6173 56.4566Z"
				fill="#020202"
			/>
			<path
				d="M194.374 80.4695C193.084 80.2331 191.896 80.0886 190.744 79.8028C188.512 79.2494 188.223 78.161 188.873 75.9164C189.392 74.1246 190.765 73.1454 192.59 72.8793C195.363 72.475 197.218 71.0361 198.149 68.3446C198.575 67.1117 199.239 65.9607 199.797 64.7738C203.061 57.8378 206.578 51.0381 209.102 43.7423C210.411 39.9561 211.205 36.0881 212.299 32.2769C212.864 30.3079 213.765 28.5609 215.463 27.3574C218.268 25.3693 223.83 26.365 224.254 31.8678C224.421 34.0314 224.544 36.199 224.756 38.3581C224.816 38.9715 225.028 39.6113 225.327 40.1527C226.348 42.0026 226.964 43.9182 226.859 46.0719C226.819 46.8724 226.99 47.7444 227.294 48.4903C229.079 52.8705 229.748 57.4768 230.445 62.1176C230.874 64.9806 232.004 67.742 232.864 70.5351C233.18 71.5584 233.882 71.9937 235.038 72.0698C236.58 72.1713 238.128 72.4995 239.623 72.9105C241.316 73.3756 242.03 74.3856 241.999 75.8452C241.958 77.7868 241.158 79.0915 239.391 79.4033C237.682 79.7048 235.909 79.6948 234.163 79.7161C229.775 79.7695 225.387 79.7626 221 79.7819C220.259 79.7852 219.518 79.7865 218.777 79.8101C217.808 79.841 216.704 79.7778 216.535 78.6857C216.405 77.845 216.746 76.8472 217.132 76.0409C217.38 75.5214 218.046 75.1417 218.602 74.8429C219.435 74.3946 220.321 74.0288 221.213 73.7067C222.52 73.2346 223.207 72.5433 222.631 71.0376C221.893 69.1079 221.219 67.1508 220.602 65.179C220.316 64.2682 220.261 63.288 220.048 62.3515C219.867 61.555 219.443 61.1122 218.493 61.1845C216.47 61.3384 214.436 61.3381 212.412 61.48C211.342 61.555 210.682 61.951 210.849 63.3331C210.96 64.2559 210.57 65.2892 210.224 66.2052C209.706 67.5787 209.039 68.8966 208.419 70.2307C207.839 71.4788 208.051 72.3278 209.394 72.99C211.226 73.8928 211.861 75.5332 211.546 77.5101C211.473 77.9718 211.238 78.6582 210.904 78.7853C209.392 79.3608 208.003 80.4654 206.147 79.715C205.202 79.3331 204.048 79.2293 203.023 79.3335C200.934 79.5457 198.871 80.0022 196.791 80.3197C196.034 80.4352 195.26 80.4415 194.374 80.4695ZM215.593 50.9371C215.164 52.416 215.425 52.8163 216.88 52.8721C217.294 52.888 217.71 52.8672 218.124 52.8454C219.096 52.7944 219.111 52.3996 218.725 51.5872C218.312 50.7183 218.017 49.751 217.894 48.7979C217.722 47.4514 217.756 46.0786 217.701 44.717C217.521 44.6885 217.341 44.66 217.16 44.6315C216.834 45.3501 216.379 46.0397 216.209 46.7935C215.921 48.0751 215.814 49.3971 215.593 50.9371Z"
				fill="#010101"
			/>
			<path
				d="M23.8932 38.722C20.8716 38.7384 19.8501 39.6609 19.9767 42.5383C20.1312 46.0469 19.4196 49.4208 18.7827 52.8251C18.4963 54.356 18.3405 55.9279 18.3041 57.4854C18.2315 60.5867 18.2705 63.6909 18.2932 66.7937C18.2975 67.3853 18.3881 67.9879 18.5261 68.5647C18.9951 70.5256 19.2449 70.7048 21.221 70.6816C22.1008 70.6712 22.9872 70.5927 23.8595 70.6701C28.7387 71.1029 32.3511 68.3703 36.0041 65.7972C37.0095 65.089 37.8145 64.0968 38.7135 63.2369C39.3714 62.6077 41.0906 62.7057 42.3336 63.4506C43.243 63.9955 44.0694 64.6624 43.6082 65.8607C41.9532 70.1608 40.2206 74.4265 37.3714 78.1243C36.4908 79.2672 35.3876 79.814 33.9232 79.8306C30.9187 79.8645 27.9156 80.0362 24.9111 80.0675C23.4864 80.0824 22.06 79.8397 20.634 79.8345C19.3712 79.8299 18.0505 79.7879 16.8559 80.122C13.8598 80.9601 10.9176 81.1892 7.87723 80.3603C7.05437 80.1359 5.93741 80.1223 5.22516 80.5088C1.95076 82.286 0.132664 80.0285 0.00879518 76.9793C-0.0976801 74.3582 0.752924 73.5507 3.08873 72.8746C4.07534 72.589 5.07261 72.3373 6.04945 72.0218C7.03415 71.7038 7.46908 70.9956 7.46013 69.9498C7.44348 68.0058 7.39007 66.0559 7.51129 64.1184C7.68578 61.3299 8.00382 58.5504 8.25682 55.7667C8.28189 55.4909 8.2743 55.2122 8.29282 54.9356C8.47689 52.1856 8.68305 49.4368 8.83249 46.6849C8.8628 46.1268 8.6747 45.5581 8.5994 44.9926C8.48563 44.1383 8.3029 43.2837 8.29158 42.4273C8.26885 40.7071 7.6822 39.3956 6.03674 38.65C3.29204 37.4064 3.25846 35.6817 3.63028 33.0761C3.86749 31.4139 6.20772 30.057 8.31917 30.0574C14.2472 30.0586 20.1752 30.0486 26.1032 30.0664C29.4649 30.0764 31.088 31.9424 30.6293 35.2387C30.5819 35.5799 30.4793 36.0494 30.238 36.206C28.3331 37.4415 26.5989 39.143 23.8932 38.722Z"
				fill="#010101"
			/>
		</svg>
	</div>
{/if}

<style>
	:root::view-transition-old(root),
	:root::view-transition-new(root) {
		animation-duration: 0.3s;
	}
</style>
